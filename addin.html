<html>
<head>
  <!--
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  -->
  <script lang="javascript">

    const options = {
      enableHighAccuracy: true,
      timeout: 5000,
      maximumAge: 0
    };

    function success(pos) {
      const crd = pos.coords;
      const divMsg = document.getElementById("divMsg");
      divMsg.innerHTML = `Location: ${window.location.href}. <br/>Your current position is: Latitude : ${crd.latitude} Longitude: ${crd.longitude} More or less ${crd.accuracy} meters.`;
    }

    function error(err) {
      //console.warn(`ERROR(${err.code}): ${err.message}`);
      const divMsg = document.getElementById("divMsg");
      divMsg.innerHTML = `Location: ${window.location.href}. <br/><span style='color:red'>ERROR(${err.code}): ${err.message}</span>`;
    }

    function onLoad() {
      console.log(window.location.href);
      navigator.geolocation.getCurrentPosition(success, error, options);
    }
    
    /*
    Office.onReady((info) => {
      console.log(window.location.href);
      navigator.geolocation.getCurrentPosition(success, error, options);
    });
    */
  </script>
</head>
<body onload="onLoad()">
  AddIn page <div id="divMsg"></div> 
</body>
</html>
