<html>
<head>
  <!--
      <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  -->
  <script lang="javascript">

    const options = {
      enableHighAccuracy: true,
      timeout: 5000,
      maximumAge: 0
    };

    function success(pos) {
      const crd = pos.coords;
      const divMsg = document.getElementById("divMsg");
      divMsg.innerHTML = `Location: ${window.location.href}. <br/>Your current position is: Latitude : ${crd.latitude} Longitude: ${crd.longitude} More or less ${crd.accuracy} meters.`;
    }

    function error(err) {
      //console.warn(`ERROR(${err.code}): ${err.message}`);
      const divMsg = document.getElementById("divMsg");
      divMsg.innerHTML = `Location: ${window.location.href}. <br/><span style='color:red'>ERROR(${err.code}): ${err.message}</span>`;
    }

    function onLoad() {
      const divApp = document.getElementById("WopiDocWACContainer");
      
      //const appFrame = document.getElementById("WebApplicationFrame");
      //appFrame.contentDocument.write('<iframe name="AgaveFrame" id="AgaveFrame" src="https://ashy-plant-03be47a10.1.azurestaticapps.net/addin.html" width="800px" height="600px" sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads allow-storage-access-by-user-activation" allow="geolocation">');
      //appFrame.contentDocument.close();
      //divApp.innerHTML = '<iframe name="AgaveFrame" id="AgaveFrame" src="https://ashy-plant-03be47a10.1.azurestaticapps.net/addin.html" width="800px" height="600px" sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads allow-storage-access-by-user-activation" allow="geolocation">';
      divApp.innerHTML = '<iframe name="WebApplicationFrame" id="WebApplicationFrame" title="Office Online Frame" width="1024px" height="768px" allow="microphone https://github.com/praveenbengeri/testweb; autoplay https://github.com/praveenbengeri/testweb; camera https://github.com/praveenbengeri/testweb; clipboard-read https://github.com/praveenbengeri/testweb; clipboard-write https://github.com/praveenbengeri/testweb; keyboard-map https://github.com/praveenbengeri/testweb;">        </iframe>';
      
      
      //navigator.geolocation.getCurrentPosition(success, error, options);
    }
    
    /*
    Office.onReady((info) => {
      console.log(window.location.href);
      navigator.geolocation.getCurrentPosition(success, error, options);
      
      
    });
    */
  </script>
</head>

<body onload="onLoad()" style="margin: 0; padding: 0; overflow:hidden; -ms-content-zooming: none;">
    WAC Main page. Embeds WAC Frame with geolocation allow not mentioned!
    <br/>
    <div id="divMsg"></div> 
    <br/>
    <div id="WopiDocWACContainer">
      <!--
        <iframe name="WebApplicationFrame" id="WebApplicationFrame" title="Office Online Frame" 
                width="1024px" height="768px"
                allow="microphone https://github.com/praveenbengeri/testweb; autoplay https://github.com/praveenbengeri/testweb; camera https://github.com/praveenbengeri/testweb; clipboard-read https://github.com/praveenbengeri/testweb; clipboard-write https://github.com/praveenbengeri/testweb; keyboard-map https://github.com/praveenbengeri/testweb;"
                >
        </iframe>
    -->
        <!--allow="geolocation *;" -->
</body>
</html>
